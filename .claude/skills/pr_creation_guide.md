# PR ìƒì„± ê°€ì´ë“œ

## ê°œìš”

ê¸°ëŠ¥ êµ¬í˜„ì´ ì™„ë£Œëœ í›„, ì½”ë“œë¥¼ ë¶„ì„í•˜ê³  ê°œë°œìžì˜ ì˜ì‚¬ê²°ì •ì„ í™•ì¸í•˜ì—¬ PR ë¬¸ì„œë¥¼ ìž‘ì„±í•˜ëŠ” 3ë‹¨ê³„ ì›Œí¬í”Œë¡œìš°ìž…ë‹ˆë‹¤.

---

## ì›Œí¬í”Œë¡œìš°

### ì „ì²´ íë¦„

```
[Step 1] volume-{n}.md          ê¹ƒ ë¡œê·¸ + ì½”ë“œ ë¶„ì„ â†’ ê°œë°œ ê¸°ë¡ ì •ë¦¬
    â†“
[Step 2] volume-{n}-question.md ì½”ë“œì—ì„œ ì˜ì‚¬ê²°ì • ì˜ë¬¸ì  ë„ì¶œ â†’ ê°œë°œìž ë‹µë³€ ìˆ˜ì§‘
    â†“
[Step 3] volume-{n}-pr.md       ë‹µë³€ ë°˜ì˜ + ì½”ë“œ ìˆ˜ì •(í•„ìš” ì‹œ) â†’ ìµœì¢… PR ë¬¸ì„œ ìƒì„±
```

ì €ìž¥ ê²½ë¡œ: `.idea/volume-{n}*.md`

---

### Step 1: ê°œë°œ ê¸°ë¡ ìž‘ì„± (`volume-{n}.md`)

ë¸Œëžœì¹˜ì˜ ì»¤ë°‹ ížˆìŠ¤í† ë¦¬ì™€ ë³€ê²½ íŒŒì¼ì„ ë¶„ì„í•˜ì—¬ ê°œë°œ íë¦„ì„ Phase ë‹¨ìœ„ë¡œ ì •ë¦¬í•œë‹¤.

#### ìˆ˜ì§‘ ì •ë³´

1. **ì»¤ë°‹ ížˆìŠ¤í† ë¦¬**: `git log {base}..HEAD` â€” í•´ì‹œ, ë‚ ì§œ, ë©”ì‹œì§€ í…Œì´ë¸”
2. **ë³€ê²½ í†µê³„**: `git diff {base}..HEAD --shortstat` â€” íŒŒì¼ ìˆ˜, ì¶”ê°€/ì‚­ì œ ë¼ì¸
3. **ì»¤ë°‹ë³„ ë³€ê²½**: `git log {base}..HEAD --stat` â€” ê° ì»¤ë°‹ì˜ ì˜í–¥ íŒŒì¼

#### êµ¬ì„±

```markdown
# Volume {n} - {ë„ë©”ì¸} êµ¬í˜„ ê¸°ë¡

## ê°œìš”
ì‹œìž‘ ì»¤ë°‹ ~ ì¢…ë£Œ ì»¤ë°‹ ë²”ìœ„, ì´ ë³€ê²½ í†µê³„

## ì»¤ë°‹ ížˆìŠ¤í† ë¦¬
| Hash | ë‚ ì§œ | ì»¤ë°‹ ë©”ì‹œì§€ |

## Phase 1: {ì£¼ì œ}
- ë³€ê²½ ë‚´ìš©, ì¶”ê°€ëœ í´ëž˜ìŠ¤/ë©”ì„œë“œ, í…ŒìŠ¤íŠ¸

## Phase N: ...

## ìµœì¢… íŒŒì¼ êµ¬ì¡°
í”„ë¡œë•ì…˜ ì½”ë“œ íŠ¸ë¦¬

## API ì—”ë“œí¬ì¸íŠ¸ í˜„í™©
| Method | Path | ì„¤ëª… | ì¸ì¦ |

## í…ŒìŠ¤íŠ¸ í˜„í™©
| ì¢…ë¥˜ | í´ëž˜ìŠ¤ | í…ŒìŠ¤íŠ¸ ìˆ˜ |

## ì•„í‚¤í…ì²˜ íŒ¨í„´ ìš”ì•½
ì ìš©ëœ íŒ¨í„´, ë¦¬íŒ©í† ë§ í¬ì¸íŠ¸
```

#### Phase ë¶„ë¥˜ ê¸°ì¤€

- ê´€ë ¨ëœ ì»¤ë°‹ì„ ê¸°ëŠ¥/ë ˆì´ì–´ ë‹¨ìœ„ë¡œ ë¬¶ëŠ”ë‹¤
- ì˜ˆ: VO êµ¬ì¶• â†’ ì„œë¹„ìŠ¤ ë ˆì´ì–´ â†’ API ë ˆì´ì–´ â†’ ë¦¬íŒ©í† ë§

---

### Step 2: ì˜ì‚¬ê²°ì • ì§ˆë¬¸ (`volume-{n}-question.md`)

ì½”ë“œë¥¼ ì „ìˆ˜ ë¶„ì„í•˜ì—¬ ì„¤ê³„/êµ¬í˜„ ì˜ë„ê°€ ë¶ˆë¶„ëª…í•œ ë¶€ë¶„ì„ ì§ˆë¬¸í•œë‹¤.

#### ì§ˆë¬¸ ë„ì¶œ ê´€ì 

| ê´€ì  | ì˜ˆì‹œ |
|------|------|
| **ë ˆì´ì–´ ê·œì¹™ ìœ„ë°˜** | Domainì—ì„œ Infrastructureë¥¼ importí•˜ê³  ìžˆëŠ”ê°€? |
| **íƒ€ìž… ì„¤ê³„ ì¼ê´€ì„±** | ì¼ë¶€ í•„ë“œë§Œ VOë¡œ ëž˜í•‘í•˜ê³  ë‚˜ë¨¸ì§€ëŠ” ì›ì‹œ íƒ€ìž…ì¸ ì´ìœ ? |
| **ì¤‘ë³µ/ë¹„íš¨ìœ¨ ë¡œì§** | ê°™ì€ ê²€ì¦ì´ ì—¬ëŸ¬ ê³³ì—ì„œ ì‹¤í–‰ë˜ëŠ”ê°€? |
| **ë¯¸ì‚¬ìš© ì½”ë“œ** | í…ŒìŠ¤íŠ¸ì—ì„œë§Œ ì“°ì´ëŠ” ìƒì„±ìž/ë©”ì„œë“œê°€ ìžˆëŠ”ê°€? |
| **ê·œì¹™ ë¶ˆì¼ì¹˜** | CLAUDE.mdì˜ ê·œì¹™ê³¼ ì‹¤ì œ ì½”ë“œê°€ ì–´ê¸‹ë‚˜ëŠ” ê³³? |
| **HTTP ì‹œë§¨í‹±** | ì—ëŸ¬ ì½”ë“œ/ì‘ë‹µ ì½”ë“œê°€ ì˜ë¯¸ì— ë§žëŠ”ê°€? |
| **ìº¡ìŠí™” ìˆ˜ì¤€** | ë‚´ë¶€ ìƒíƒœ(getter)ê°€ ë¶ˆí•„ìš”í•˜ê²Œ ë…¸ì¶œë˜ëŠ”ê°€? |

#### ì§ˆë¬¸ í˜•ì‹

```markdown
## {ë²ˆí˜¸}. {ì£¼ì œ í•œ ì¤„}

{í˜„ìƒ ì„¤ëª… â€” ì½”ë“œ ì¸ìš© í¬í•¨}

{ì™œ ì˜ë¬¸ì¸ì§€ ê·¼ê±° â€” CLAUDE.md ê·œì¹™, HTTP í‘œì¤€, ì„¤ê³„ ì›ì¹™ ë“±}

**{í•µì‹¬ ì§ˆë¬¸ â€” êµµê²Œ}**
```

#### ê°œë°œìž ë‹µë³€ ìœ í˜•ê³¼ í›„ì† ì²˜ë¦¬

| ë‹µë³€ ìœ í˜• | í›„ì† ì²˜ë¦¬ |
|-----------|----------|
| "ì‚­ì œí•´ì¤˜" | PRì—ì„œ í•´ë‹¹ í•­ëª© ì œì™¸ |
| "ì˜ë„ì  ê²°ì •ìž…ë‹ˆë‹¤. ì´ìœ ëŠ”..." | PRì˜ Context & Decisionì— ê·¼ê±° ì„œìˆ  |
| "ìˆ˜ì • ë°”ëžë‹ˆë‹¤" | ì½”ë“œ ìˆ˜ì • í›„ PRì— Before/After ê¸°ë¡ |
| "ì¶”ì²œí•´ì£¼ê³  ìˆ˜ì •í•´ì£¼ì„¸ìš”" | ë°©ì•ˆ ì œì‹œ â†’ ì½”ë“œ ìˆ˜ì • â†’ PRì— ê¸°ë¡ |
| "ìš”êµ¬ì‚¬í•­ìž…ë‹ˆë‹¤" | PRì—ì„œ í•´ë‹¹ í•­ëª© ì œì™¸ |

---

### Step 3: PR ë¬¸ì„œ ìž‘ì„± (`volume-{n}-pr.md`)

ë‹µë³€ì„ ë°˜ì˜í•˜ì—¬ ìµœì¢… PR ë¬¸ì„œë¥¼ ìƒì„±í•œë‹¤.

#### PR í…œí”Œë¦¿ êµ¬ì¡°

```markdown
## ðŸ“Œ Summary

* ë°°ê²½: {ê¸°ì¡´ ìƒíƒœì˜ ë¬¸ì œì /í•œê³„ë¥¼ 1~2ë¬¸ìž¥ìœ¼ë¡œ}
* ëª©í‘œ: {ì´ PRì´ ë‹¬ì„±í•˜ë ¤ëŠ” ê²ƒì„ 1~2ë¬¸ìž¥ìœ¼ë¡œ}
* ê²°ê³¼: {ì‹¤ì œë¡œ ë‹¬ì„±í•œ ê²ƒ â€” ê¸°ëŠ¥, í…ŒìŠ¤íŠ¸ ìˆ˜, ì£¼ìš” ê°œì„ ì }

---

## ðŸ§­ Context & Decision

### ë¬¸ì œ ì •ì˜

* í˜„ìž¬ ë™ìž‘/ì œì•½:
    * {í˜„ìž¬ ì½”ë“œì˜ ìƒíƒœë‚˜ ì œì•½ì‚¬í•­ì„ bulletìœ¼ë¡œ ë‚˜ì—´}
* ë¬¸ì œ(ë˜ëŠ” ë¦¬ìŠ¤í¬):
    * {ì´ ìƒíƒœë¥¼ ë°©ì¹˜í•˜ë©´ ìƒê¸°ëŠ” ë¬¸ì œì }
* ì„±ê³µ ê¸°ì¤€(ì™„ë£Œ ì •ì˜):
    * {PRì´ ì™„ë£Œëœ ê²ƒìœ¼ë¡œ ê°„ì£¼ë˜ëŠ” ì¡°ê±´}

### ì„ íƒì§€ì™€ ê²°ì •

* ê³ ë ¤í•œ ëŒ€ì•ˆ:
    * A: {ëŒ€ì•ˆ A ì„¤ëª…}
    * B: {ëŒ€ì•ˆ B ì„¤ëª…}
* ìµœì¢… ê²°ì •: **{A ë˜ëŠ” B} ì„ íƒ**
* íŠ¸ë ˆì´ë“œì˜¤í”„:
    * {ì„ íƒìœ¼ë¡œ ì–»ëŠ” ê²ƒê³¼ í¬ê¸°í•˜ëŠ” ê²ƒ}
* ì¶”í›„ ê°œì„  ì—¬ì§€(ìžˆë‹¤ë©´):
    * {í–¥í›„ ë³€ê²½ ê°€ëŠ¥ì„±ì´ ìžˆëŠ” ë¶€ë¶„}

---

## ðŸ—ï¸ Design Overview

### ë³€ê²½ ë²”ìœ„

* ì˜í–¥ ë°›ëŠ” ëª¨ë“ˆ/ë„ë©”ì¸:
    * {ëª¨ë“ˆ/íŒ¨í‚¤ì§€ ëª©ë¡}
* ì‹ ê·œ ì¶”ê°€:
    * {ìƒˆë¡œ ì¶”ê°€ëœ í´ëž˜ìŠ¤, API, ê¸°ëŠ¥}
* ì œê±°/ëŒ€ì²´:
    * {ì‚­ì œëœ ê²ƒ, ëŒ€ì²´ëœ ê²ƒ}

### ì£¼ìš” ì»´í¬ë„ŒíŠ¸ ì±…ìž„

* `{í´ëž˜ìŠ¤ëª…}`:
    * {ì´ í´ëž˜ìŠ¤ê°€ ë§¡ëŠ” ì—­í•  ì„¤ëª…}
* ...

---

## ðŸ” Flow Diagram

### Main Flow

#### {n}) {API ì´ë¦„} `{METHOD} {PATH}`

```mermaid
sequenceDiagram
  autonumber
  participant Client
  participant Controller as {Controllerëª…}
  participant Service as {Serviceëª…}
  ...

  Client->>Controller: {HTTP ë©”ì„œë“œ} {ê²½ë¡œ}\n{ìš”ì²­ ì„¤ëª…}
  Controller->>Service: {ë©”ì„œë“œ í˜¸ì¶œ}
  ...
  alt {ì‹¤íŒ¨ ì¡°ê±´}
    ...-->>Client: {ì—ëŸ¬ ì½”ë“œ} ApiResponse FAIL
  else {ì„±ê³µ ì¡°ê±´}
    ...-->>Client: {ì„±ê³µ ì½”ë“œ} ApiResponse SUCCESS
  end
```

### ì˜ˆì™¸ íë¦„

```mermaid
sequenceDiagram
  autonumber
  participant App as ApiControllerAdvice
  participant Client

  Note over App: CoreException(ErrorType) ë°œìƒ ì‹œ
  App-->>Client: {ì½”ë“œ} {ErrorType}
  ...
```

---
```

---

## Mermaid Sequence Diagram ìž‘ì„± ê·œì¹™

### participant êµ¬ì„±

í”„ë¡œì íŠ¸ ë ˆì´ì–´ êµ¬ì¡°ì— ë§žì¶° participantë¥¼ ë°°ì¹˜í•œë‹¤:

```
Client â†’ Controller â†’ Service/Facade â†’ Reader â†’ Repository â†’ Model â†’ DB
                                                                â†•
                                                           PasswordHasher ë“± ì¸í”„ë¼
```

### ê·œì¹™

1. **autonumber ì‚¬ìš©**: ë©”ì‹œì§€ì— ìˆœì„œ ë²ˆí˜¸ë¥¼ ë¶™ì¸ë‹¤
2. **alt/else ë¸”ë¡**: ì„±ê³µ/ì‹¤íŒ¨ ë¶„ê¸°ë¥¼ ëª…í™•ížˆ í‘œí˜„í•œë‹¤
3. **ì—ëŸ¬ ì‘ë‹µì— ErrorType ëª…ì‹œ**: `CoreException(CONFLICT)` í˜•íƒœë¡œ ì–´ë–¤ íƒ€ìž…ì¸ì§€ í‘œê¸°
4. **self-call í‘œí˜„**: `Model->>Model: validateRawPassword()` â€” ë‚´ë¶€ ê²€ì¦ ë¡œì§
5. **JPA dirty checking**: save() ì—†ì´ `TX commit (dirty checking flush)`ë¡œ í‘œí˜„

### ì˜ˆì‹œ íŒ¨í„´

#### ì¡°íšŒ + ì¸ì¦

```mermaid
sequenceDiagram
  Service->>Reader: getOrThrow(id)
  Reader->>Repo: findByMemberId(id)
  Repo->>DB: SELECT ...
  alt not found
    Reader-->>Service: throw CoreException(NOT_FOUND)
  else found
    Service->>Model: verifyPassword(hasher, pw)
    alt mismatch
      Service-->>Controller: throw CoreException(UNAUTHORIZED)
    else ok
      Service-->>Controller: response
    end
  end
```

#### ë„ë©”ì¸ í–‰ìœ„ (ë‹¤ë‹¨ê³„ ê²€ì¦)

```mermaid
sequenceDiagram
  Service->>Model: changePassword(currentPw, newPw)
  Model->>Hasher: matches(currentPw, hashed)
  alt mismatch
    Model-->>Service: throw CoreException(BAD_REQUEST)
  else ok
    Model->>Model: validateRawPassword(newPw)
    Model->>Hasher: hash(newPw)
    Hasher-->>Model: newHashed
    Model->>Model: set password = newHashed
    Service->>DB: TX commit (dirty checking flush)
  end
```

---

## Summary ìž‘ì„± ê·œì¹™

### ë°°ê²½ (Background)

- "~í–ˆì§€ë§Œ, ~í•´ì„œ ~ì´ ì•½í–ˆë‹¤" í˜•íƒœë¡œ í˜„ìž¬ ìƒíƒœì˜ í•œê³„ë¥¼ ì„œìˆ 
- ê¸°ìˆ ì  ì‚¬ì‹¤ ìœ„ì£¼, ì£¼ê´€ì  í‰ê°€ ë°°ì œ

### ëª©í‘œ (Objective)

- "~í•˜ê³ , ~í•œë‹¤" í˜•íƒœë¡œ ì´ PRì´ ë‹¬ì„±í•  ê²ƒì„ ì„œìˆ 
- ë²”ìœ„ë¥¼ ëª…í™•ížˆ í•œì •

### ê²°ê³¼ (Result)

- ì‹¤ì œ ì‚°ì¶œë¬¼ ë‚˜ì—´: ê¸°ëŠ¥ ìˆ˜, í…ŒìŠ¤íŠ¸ ìˆ˜, ì£¼ìš” ê°œì„ ì 
- ì •ëŸ‰ì  ì§€í‘œ í¬í•¨ (í…ŒìŠ¤íŠ¸ Nê°œ í†µê³¼ ë“±)

---

## Context & Decision ìž‘ì„± ê·œì¹™

### volume-{n}-question.mdì˜ ë‹µë³€ ë°˜ì˜ ë°©ì‹

| ë‹µë³€ ìœ í˜• | ë°˜ì˜ ìœ„ì¹˜ |
|-----------|----------|
| ì˜ë„ì  ê²°ì • + ì´ìœ  | "ì„ íƒì§€ì™€ ê²°ì •"ì˜ **ìµœì¢… ê²°ì •** + **íŠ¸ë ˆì´ë“œì˜¤í”„** |
| ì½”ë“œ ìˆ˜ì • ìš”ì²­ | "Design Overview"ì˜ **ì œê±°/ëŒ€ì²´**ì— Beforeâ†’After ê¸°ë¡ |
| í–¥í›„ ê³„íš ì–¸ê¸‰ | **ì¶”í›„ ê°œì„  ì—¬ì§€** |
| ì‚­ì œ/ìš”êµ¬ì‚¬í•­ | PRì—ì„œ ì œì™¸ (ì–¸ê¸‰í•˜ì§€ ì•ŠìŒ) |

### ì„ íƒì§€ ì„œìˆ 

- ìµœì†Œ 2ê°œ ëŒ€ì•ˆì„ ì œì‹œ (ì‹¤ì œ ê³ ë ¤í•˜ì§€ ì•Šì•˜ë”ë¼ë„ "ì™œ ì•ˆ í–ˆëŠ”ì§€"ë¥¼ ì„¤ëª…í•˜ê¸° ìœ„í•´)
- ê° ëŒ€ì•ˆì„ `A: ...`, `B: ...` í˜•íƒœë¡œ ê°„ê²°í•˜ê²Œ
- íŠ¸ë ˆì´ë“œì˜¤í”„ëŠ” "~ì€ í¬ê¸°í•˜ì§€ë§Œ, ~ì„ ì–»ëŠ”ë‹¤" í˜•íƒœ

---

## Design Overview ìž‘ì„± ê·œì¹™

### ë³€ê²½ ë²”ìœ„

- **ì˜í–¥ ë°›ëŠ” ëª¨ë“ˆ/ë„ë©”ì¸**: íŒ¨í‚¤ì§€ ê²½ë¡œë¡œ ëª…ì‹œ
- **ì‹ ê·œ ì¶”ê°€**: í´ëž˜ìŠ¤ëª… + ì—­í• ì„ í•œ ì¤„ë¡œ
- **ì œê±°/ëŒ€ì²´**: "X ì œê±° â†’ Yë¡œ ëŒ€ì²´" í˜•íƒœ

### ì£¼ìš” ì»´í¬ë„ŒíŠ¸ ì±…ìž„

- í”„ë¡œì íŠ¸ ë ˆì´ì–´ë³„ë¡œ í•µì‹¬ í´ëž˜ìŠ¤ë¥¼ ë‚˜ì—´
- ê° í´ëž˜ìŠ¤ê°€ "ë¬´ì—‡ì„ ë‹´ë‹¹í•˜ëŠ”ì§€"ë¥¼ bulletìœ¼ë¡œ ì„¤ëª…
- CLAUDE.mdì˜ ë ˆì´ì–´ë³„ ì—­í•  ì •ì˜ì™€ ì¼ì¹˜ì‹œí‚¨ë‹¤

---

## ì°¸ê³ : volume-1 ì‹¤ì œ ì ìš© ì‚¬ë¡€

### ì§ˆë¬¸ì—ì„œ PRê¹Œì§€ì˜ íë¦„

```
[ì§ˆë¬¸] "passwordê°€ VOê°€ ì•„ë‹Œ ì´ìœ ?"
    â†“
[ë‹µë³€] "í•´ì‹œëœ ê°’ì´ VO ê²€ì¦ì„ í†µê³¼í•˜ì§€ ëª»í•˜ê¸° ë•Œë¬¸. ì˜ë„ì  ê²°ì •."
    â†“
[PR ë°˜ì˜]
  Context & Decision > ì„ íƒì§€ì™€ ê²°ì •:
    A: passwordë„ VOë¡œ ëž˜í•‘ + Converter
    B: String(í•´ì‹œ) ìœ ì§€ + í–‰ìœ„ ë©”ì„œë“œë¡œ ì œí•œ
    ìµœì¢… ê²°ì •: B ì„ íƒ
    íŠ¸ë ˆì´ë“œì˜¤í”„: íƒ€ìž… ì•ˆì •ì„±ì€ í¬ê¸°í•˜ì§€ë§Œ í•´ì‹œ íŠ¹ìˆ˜ì„±ì„ ê¹¨ë—í•˜ê²Œ ì²˜ë¦¬
```

```
[ì§ˆë¬¸] "ErrorTypeì´ BAD_REQUESTë¡œ ê³¼ë„í•˜ê²Œ ì‚¬ìš©ë¨"
    â†“
[ë‹µë³€] "ìˆ˜ì • ë°”ëžë‹ˆë‹¤"
    â†“
[ì½”ë“œ ìˆ˜ì •] UNAUTHORIZED/CONFLICT ì¶”ê°€, ì„œë¹„ìŠ¤ ì½”ë“œ ë³€ê²½, í…ŒìŠ¤íŠ¸ ìˆ˜ì •
    â†“
[PR ë°˜ì˜]
  Design Overview > ì œê±°/ëŒ€ì²´:
    ErrorType: UNAUTHORIZED(401) ë“± ì‹œë§¨í‹± ë¶„ë¦¬
  Summary > ê²°ê³¼:
    ErrorType(CONFLICT/UNAUTHORIZED) ë¶„ë¦¬
```

```
[ì§ˆë¬¸] "password @Getterê°€ ë…¸ì¶œë¨"
    â†“
[ë‹µë³€] "ê²Œí„° ì œê±°í•˜ê³  í–‰ìœ„ ë©”ì„œë“œë¡œ ì œí•œí•´ì£¼ì„¸ìš”"
    â†“
[ì½”ë“œ ìˆ˜ì •] @Getter ì œê±°, verifyPassword() ì¶”ê°€, í…ŒìŠ¤íŠ¸ ì „í™˜
    â†“
[PR ë°˜ì˜]
  Design Overview > ì œê±°/ëŒ€ì²´:
    password getter ì œê±° â†’ verifyPassword() í–‰ìœ„ ë©”ì„œë“œë¡œ ëŒ€ì²´
```
